# Kernel Exploits

## Table of Contents

1. [Overview](#overview)
2. [Identifying Kernel Version](#identifying-kernel-version)
3. [Finding Exploits](#finding-exploits)
4. [Notable Kernel CVEs](#notable-kernel-cves)

---

## Overview

If the kernel is outdated, it may be vulnerable to known CVEs that allow local privilege escalation. Kernel exploits are powerful (direct root) but risky — they can crash the system. Use them as a last resort when other privesc vectors fail.

## Identifying Kernel Version

```bash
# Kernel version
uname -r

# Full system info (kernel + arch + distro)
uname -a

# Distribution details
cat /etc/os-release
cat /etc/issue
lsb_release -a 2>/dev/null
```

Example output:

```
5.4.0-42-generic    → kernel 5.4.0, patch 42, generic flavor
```

You need the **kernel version** and the **distribution** to find matching exploits.

## Finding Exploits

### Automated tools

```bash
# linux-exploit-suggester — matches kernel version to known CVEs
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
chmod +x linux-exploit-suggester.sh
./linux-exploit-suggester.sh

# linux-exploit-suggester2 (Perl version)
perl linux-exploit-suggester-2.pl
```

### Manual search

```bash
# Search on Exploit-DB
searchsploit linux kernel <version>
searchsploit linux kernel 5.4

# Or use the web version
# https://www.exploit-db.com/
```

### Compile and run

Most kernel exploits are in C:

```bash
# On attacker machine (or target if gcc is available)
gcc exploit.c -o exploit
chmod +x exploit

# Transfer to target and run
./exploit
```

> **Tip:** If the target doesn't have `gcc`, compile on a machine with the same architecture and transfer the binary.

## Notable Kernel CVEs

| CVE | Name | Affected Kernels | Description |
|---|---|---|---|
| CVE-2016-5195 | **Dirty COW** | < 4.8.3 | Race condition in copy-on-write. Write to read-only files |
| CVE-2022-0847 | **Dirty Pipe** | 5.8 — 5.16.11 | Overwrite data in read-only files via pipe |
| CVE-2022-2588 | **DirtyCred** | 5.8+ | Exploit credential structures via `cls_route` |
| CVE-2023-0386 | **OverlayFS** | < 6.2 | Privilege escalation via OverlayFS copy_up |
| CVE-2023-32233 | **Netfilter** | < 6.3.2 | Use-after-free in nf_tables |
