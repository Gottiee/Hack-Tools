# Local Service CVE Exploitation

## Table of Contents

1. [Overview](#overview)
2. [Identifying Running Services](#identifying-running-services)
3. [Finding CVEs](#finding-cves)
4. [Exploitation Workflow](#exploitation-workflow)

---

## Overview

Services running locally (databases, web servers, mail daemons, etc.) may be outdated and vulnerable to known CVEs. Unlike kernel exploits, these target specific software at a specific version. Exploitation can lead to privilege escalation if the service runs as root, or to lateral movement if it runs as another user.

> **Note:** Your SSH example is a good illustration — CVE-2024-6387 (regreSSHion) in OpenSSH < 9.8 allows unauthenticated remote code execution as root.

## Identifying Running Services

```bash
# List all running processes with their user
ps aux

# Show listening ports and which process owns them
ss -tlnp
netstat -tlnp 2>/dev/null

# List services managed by systemd
systemctl list-units --type=service --state=running

# Get the version of a specific service
dpkg -l | grep <service>          # Debian/Ubuntu
rpm -qa | grep <service>          # RHEL/CentOS
<binary> --version                # Most binaries support this
```

Focus on services running as **root** — those are the ones that give direct privesc:

```bash
# Processes running as root
ps aux | grep ^root
```

## Finding CVEs

```bash
# Search Exploit-DB by service name and version
searchsploit apache 2.4.49
searchsploit mysql 5.7

# Search for specific CVEs
searchsploit --cve 2024-6387
```

### Online resources

- [Exploit-DB](https://www.exploit-db.com/) — searchable archive with ready-to-use exploits
- [NVD (NIST)](https://nvd.nist.gov/) — official CVE database with severity scores
- [CVE Details](https://www.cvedetails.com/) — browse CVEs by product and version

### Notable local service CVEs

| CVE | Service | Description |
|---|---|---|
| CVE-2024-6387 | OpenSSH < 9.8 | regreSSHion — unauthenticated RCE as root |
| CVE-2021-4034 | polkit (pkexec) | PwnKit — LPE via memory corruption in pkexec |
| CVE-2021-3156 | sudo < 1.9.5p2 | Baron Samedit — heap overflow in sudoedit |
| CVE-2021-41773 | Apache 2.4.49 | Path traversal + RCE |
| CVE-2012-1823 | PHP-CGI < 5.4.2 | Argument injection → RCE |
| CVE-2019-5736 | runc < 1.0-rc6 | Container escape via /proc/self/exe overwrite |

## Exploitation Workflow

1. **Enumerate** — list running services and their versions

```bash
ps aux
ss -tlnp
dpkg -l 2>/dev/null | grep -i <service>
```

2. **Search** — find matching CVEs

```bash
searchsploit <service> <version>
```

3. **Verify** — confirm the target is vulnerable (check exact version, patch level, configuration)

4. **Exploit** — download/compile and run

```bash
# From Exploit-DB
searchsploit -m <exploit_id>    # copy exploit to current dir
gcc exploit.c -o exploit         # compile if needed
./exploit                        # run
```

5. **Fallback** — if no public exploit exists, check GitHub for PoCs:

```bash
# Search GitHub for "CVE-XXXX-XXXXX"
# Many researchers publish PoCs shortly after disclosure
```
